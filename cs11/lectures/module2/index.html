<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Lecture 11 - More Events and Timers</title>

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="../../reveal/css/reveal.css">
		<link rel="stylesheet" href="../../reveal/css/theme/black.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="../../reveal/lib/css/zenburn.css">
		<link rel="stylesheet" href="../../reveal/css/154-override.css">
    <!-- <link rel="stylesheet" href="hidden/lec10.css"> -->

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? '../../reveal/css/print/pdf.css' :
			'../../reveal/css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
    <script src="hidden/lec11js.js" type="text/javascript"></script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>
		<div class="reveal">
			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h1>CSE 154</h1>
					<h3>Lecture 11: More on events</h3>
				</section>

				<section>
					<h2>Announcement & Reminders </h2>
					<p>First exploration session Thursday 5:30-6:20,  MGH 241</p>
					<p>
						<a href="https://www.cs.washington.edu/research/nlp/soundingboardevent">
						Let's Chat Sounding Board!</a> event Friday 4pm
					</p>
					<p>
						<a href="https://catalyst.uw.edu/webq/survey/jsand89/353532">
						Special requests for exam seating</a> (closes 4/23)</p>
					<p>HW3 due today</p>
					<div>
						<img src="../img/syllabus.png" alt="read the syllabus">
					</div>
				</section>

				<section>
					<h2>Follow up notes</h2>
					<p>
						<a href="https://www.w3schools.com/html/html5_semantic_elements.asp">Semantic tags</a>
						vs "Tags with Semantic Meaning"
					</p>
					<p>
						Selectors used in <code>querySelector</code> or
						<code>querySelectorAll</code> do not have to be listed in
						<strong>your</strong> <code>.css</code> file </p>
					<p>
					<p space-left>
						All of the selectors listed in the <code>.html</code> "exist" in
						the namespace of the page as it is rendered. The styles you define in your
						<code>.css</code> file overrride the default styles for every selector.
					</p>
					<p>
						You experienced .classList.remove("hidden") in lab. Today we'll
						explain more about it (demo)
					</p>
					<p><a href="clockexample.zip">Clock example</a> (thanks Jeremy!)</p>
					<p>
						But first, quickly finishing lecture 10...
					</p>
				</section>


				<section>
					<h2>Trying to add two or more event handlers</h2>
					<p>Using assigment (what we've used so far)</p>
					<pre><code class="hljs" data-trim>
					let button = document.getElementById("mybutton");
					// handleButton initially gets set as the onclick handler
					button.onclick = handleButton;
					// This handleButton2 overrides the handleButton click handler
					button.onclick = handleButton2;
					</code></pre>
					<p class="code-caption">JS (example)</p>

					<p>
						If you assign <code>onclick</code> twice, the second
						assignment replaces the first.
					</p>

				</section>

				<section>
					<h2>Solution! Use <code>addEventListener</code></h2>
					<p>
						<code>addEventListener</code> allows multiple listeners to be
						called for the same event
					</p>

					<pre><code class="hljs" data-trim>
					element.addEventListener("event", function);
					</code></pre>
					<p class="code-caption">JS (template)</p>

					<pre><code class="hljs" data-trim>
					let button = document.getElementById("mybutton");
					button.addEventListener("click", func1); // button.onclick = func1
					button.addEventListener("click", func2); // button.onclick = func2
					</code></pre>
					<p class="code-caption">JS (example)</p>
					<p>
						Both will now work.
					</p>
					<p>
						<em>Note that you do not include "on" in the event name!</em>
					</p>
				</section>


				<section>
					<h2>Multiple <code>window.onload</code> Listeners</h2>
					<pre><code class="hljs" data-trim data-noescape>
					<del class="bad">window.onload = function;</del>
					window.addListener("load", function);
					</code></pre>
					<p class="code-caption">JS</p>

					<p>
						It is generally considered bad form to directly assign to
						<code>window.onload</code> (though it is ok for this class)
					</p>
					<p>
						Multiple <code>.js</code> files could be linked to the same
						page, and if they all need to run code when the page loads, their
						<code>window.onload</code> statements will override each other
					</p>
					<p>
						By calling <code>window.addEventListener</code> instead, all of them
						can run their code when the page is loaded
					</p>
				</section>



        <section>
					<h2>More JavaScript Events</h2>
				</section>

        <section>
					<h2>JavaScript Events</h2>
          <table class="code-table-no-heading">
            <tr>
              <td>abort</td>
              <td>blur</td>
              <td>change</td>
              <td>click</td>
              <td>dblclick</td>
              <td>error</td>
              <td>focus</td>
            </tr>
            <tr>
              <td>keydown</td>
              <td>keypress</td>
              <td>keyup</td>
              <td>load</td>
              <td>mousedown</td>
              <td>mousemove</td>
              <td>mouseout</td>
            </tr>
            <tr>
              <td>mouseover</td>
              <td>mouseup</td>
              <td>reset</td>
              <td>resize</td>
              <td>select</td>
              <td>submit</td>
              <td>unload</td>
            </tr>
          </table>

          <p>
            The <code>click</code> event (<code>onclick</code>) is just one of
            many events that can be handled
          </p>
        </section>

        <section>
          <h2>The Event Object</h2>
          <pre><code class="hljs" data-trim>
          function name (event) {
            // an event handler function...
          }
          </code></pre>
          <p class="code-caption">JS (template)J</p>
          <p>
            Event handlers can accept an optional parameter to represent
            the event that is occurring
          </p>
          <p>Event objects have the following properties/methods:</p>
          <table class="code-table">
            <tr>
              <th>Property</th>
              <th>Description</th>
            </tr>
            <tr>
              <td>type</td>
              <td>what kind of event, such as "click" or "mousedown"</td>
            </tr>
            <tr>
              <td>target</td>
              <td>the element on which the event occurred</td>
            </tr>
            <tr>
              <td>timestamp</td>
              <td>when the event occurred</td>
            </tr>
          </table>
        </section>

        <section>
          <h2>Mouse Events</h2>
          <p><strong>Clicking</strong></p>
          <table class="code-table">
            <tr>
              <th>Name</th>
              <th>Description</th>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onclick.asp" target="_blank">click</a></td>
              <td>user presses/releases mouse button on the element</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_ondblclick.asp" target="_blank">dblclick</a></td>
              <td>user presses/releases mouse button twice on the element</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onmousedown.asp" target="_blank">mousedown</a></td>
              <td>user presses down mouse button on the element</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onmouseup.asp" target="_blank">mouseup</a></td>
              <td>user releases mouse button on the element</td>
            </tr>
          </table>
          <p><strong>Movement</strong></p>
          <table class="code-table">
            <tr>
              <th>Name</th>
              <th>Description</th>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onmouseover.asp" target="_blank">mouseover</a></td>
              <td>mouse cursor enters the element's box</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onmouseout.asp" target="_blank">mouseout</a></td>
              <td>mouse cursor exits the element's box</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onmousemove.asp" target="_blank">mousemove</a></td>
              <td>mouse cursor moves around within the element's box</td>
            </tr>
          </table>
        </section>

        <section>
          <h2>Mouse Events</h2>
          <table style="width: 55%" class="code-table">
            <tr>
              <th>Property/Method</th>
              <th>Description</th>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_clientx.asp" target="_blank">clientX</a><br/><a href="https://www.w3schools.com/jsref/event_clienty.asp" target="_blank">clientY</a></td>
              <td>coordinates in browser window</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_screenx.asp" target="_blank">screenX</a><br/><a href="https://www.w3schools.com/jsref/event_screeny.asp" target="_blank">screenY</a></td>
              <td>coordinates in screen</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_offsetx.asp" target="_blank">offsetX</a><br/><a href="https://www.w3schools.com/jsref/event_offsety.asp" target="_blank">offsetY</a></td>
              <td>coordinates in element (non-standard)</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_button.asp" target="_blank">button</a></td>
              <td>
                integer representing which button was pressed (0=Left
                <br />
                1=Middle, 2=Right)
              </td>
            </tr>
          </table>
          <img src="hidden/mouseevent.png" alt="mouse event" class="figureright space-left"
          style="width: 40%; margin-left: 20px;"/>
        </section>

        <section>
          <h2>Mouse Event Example</h2>
          <pre id="target"><code class="hljs" data-trim>
          Move the mouse over me!
          </code></pre>
          <p class="code-caption">HTML</p>

          <pre><code class="hljs" data-trim>
          window.onload = function() {
            let target = document.getElementById("target");
            document.getElementById("target").addEventListener("mousemove", showCoords);
          };

          function showCoords(event) {
            document.getElementById("targetoutput").innerHTML =
               "screen : (" + event.screenX + ", " + event.screenY + ")\n"
            +  "client : (" + event.clientX + ", " + event.clientY + ")\n";
          }
          </code></pre>
          <p class="code-caption">JS</p>
          <div class="output">
            <pre id="targetoutput" style="font-size: 14pt;">screen : (333, 782)
client : (222, 460)
button : 0</pre>
            <p class="output-caption">output</p>
          </div>
        </section>

        <section>
          <h2>Keyboard/Text Events</h2>
          <table class="code-table">
            <tr>
              <th>Name</th>
              <th>Description</th>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onfocus.asp" target="_blank">focus</a></td>
              <td>
                this element gains keyboard <strong>focus</strong>
                (attention of user's keyboard)
              </td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onblur.asp" target="_blank">blur</a></td>
              <td>this element loses keyboard focus</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onkeydown.asp" target="_blank">keydown</a></td>
              <td>user presses a key while this element has keyboard focus</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onkeyup.asp" target="_blank">keyup</a></td>
              <td>user releases a key while this element has keyboard focus</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onkeypress.asp" target="_blank">keypress</a></td>
              <td>user presses and releases a key while this element has keyboard focus</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onselect.asp" target="_blank">select</a></td>
              <td>this element's text is selected or deselected</td>
            </tr>
          </table>
        </section>
        <section>
          <h2>Key Event Objects</h2>
          <table class="code-table">
            <tr>
              <th>Property Name</th>
              <th>Description</th>
            </tr>
            <tr>
              <td>keyCode</td>
              <td>
                ASCII integer value of key that was pressed
                (convert to char with <code>String.fromCharCode</code>)
              </td>
            </tr>
            <tr>
              <td>altKey, ctrlKey, shiftKey</td>
              <td>true if Alt/Ctrl/Shift key is being held</td>
            </tr>
          </table>
          <p>
            Issue: if the event you attach your listener to doesn't
            have the focus, you won't hear the event
          </p>
          <p>
            Possible solution: attach key listener to entire page body,
            <code>document</code>, an outer element, etc.
          </p>
        </section>

        <section>
          <h2>Key Event Example</h2>
          <pre><code class="hljs" data-trim data-noescape>
document.getElementById("textbox").onkeydown = textKeyDown;
...
function textKeyDown(event) {
  let key = String.fromCharCode(event.keyCode);
	document.getElementById("textboxoutput").innerHTML =
		 "key : " + event.keyCode + "\n" +
	+  "altKey : " + event.altKey + "\n" +
	+  "ctrlKey : " + event.altKey;
  }
}
          </code></pre>
					<div class="output">
						<input type="text" id="textbox" />
						<pre id="textboxoutput" style="font-size: 14pt;" data-trim >
key :
altKey :
ctrlKey : </pre>
						<p class="output-caption">output</p>
					</div>
          <p>
            Each time you push down any key, even a modifier such as
            Alt or Ctrl, the <code>keydown</code> event fires
          </p>
          <p>
            If you hold down the key, the <code>keydown</code> event fires
            repeatedly
          </p>
          <p>
            <code>keypress</code> event is a bit flakier and
            inconsistent across browsers
          </p>
        </section>

        <section>
          <h2>Some Useful Keycodes</h2>
          <table class="code-table">
            <tr>
              <th>Keyboard Key</th>
              <th>Event Keycode</th>
            </tr>
            <tr>
              <td>Backspace</td>
              <td>8</td>
            </tr>
            <tr>
              <td>Tab</td>
              <td>9</td>
            </tr>
            <tr>
              <td>Enter</td>
              <td>13</td>
            </tr>
            <tr>
              <td>Escape</td>
              <td>27</td>
            </tr>
            <tr>
              <td>Page Up, Page Down, End, Home</td>
              <td>33, 34, 35, 36</td>
            </tr>
            <tr>
              <td>Left, Up, Right, Down</td>
              <td>37, 38, 39, 40</td>
            </tr>
            <tr>
              <td>Insert, Delete</td>
              <td>45, 46</td>
            </tr>
            <tr>
              <td>Window/Command</td>
              <td>91</td>
            </tr>
            <tr>
              <td>F1-F12</td>
              <td>112-123</td>
            </tr>
          </table>
        </section>

        <section>
          <h2>Page/Window Events</h2>
          <table class="code-table">
            <tr>
              <th>Name</th>
              <th>Description</th>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_oncontextmenu.asp" target="_blank">contextmenu</a></td>
              <td>
                the user right-clicks to pop up a context menu
              </td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onerror.asp" target="_blank">error</a></td>
              <td>an error occurs when loading a document or an image</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onload.asp" target="_blank">load</a></td>
              <td>the browser loads the page</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onresize.asp" target="_blank">resize</a></td>
              <td>the browser window is resized</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onscroll.asp" target="_blank">scroll</a></td>
              <td>the user scrolls the viewable part of the page up/down/left/right</td>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_onunload.asp" target="_blank">unload</a></td>
              <td>the browser exits/leaves the page</td>
            </tr>
          </table>
          <p>The above can be handled on the <code>window</code> object</p>
        </section>


        <section>
          <h2>Stopping an Event</h2>
          <table class="code-table">
            <tr>
              <th>Event Method</th>
              <th>Description</th>
            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_preventdefault.asp" target="_blank">preventDefault</a></td>
              <td>
                stops the browser from doing its normal action on an event; for<br/>
                example, stops the browser from following a link when &lt;a&gt; tag <br /> is
                clicked
              </td>

            </tr>
            <tr>
              <td><a href="https://www.w3schools.com/jsref/event_preventdefault.asp" target="_blank">stopPropagation</a></td>
              <td>stops the browser from showing this event to any other objects that may be
                listening to it</td>
            </tr>
          </table>
          <p>
            You can also <code>return false;</code> from your event handler to
            stop an event
          </p>
        </section>
        <section>
          <h2>Stopping an Event, example</h2>
          <pre><code class="hljs" data-trim>
          <form id="exampleform" action="http://foo.com/foo.php">...</form>
          </code></pre>
          <p class="code-caption">HTML</p>

          <pre><code class="hljs" data-trim>
          window.onload = function() {
            let form = document.getElementById("exampleform");
            form.onsubmit = checkData;
          };

          function checkData(event) {
            if (document.getElement("state").length != 2) {
              alert("Error, invalid city/state."); // show error message
              event.preventDefault();
              return false; // stop form submission
            }
          }
          </code></pre>
          <p class="code-caption">JS</p>
        </section>

				<section>
					<h2>Event Handler Binding</h2>
					<pre><code class="hljs" data-trim>
					window.onload = function() {
						document.getElementById("textbox").onmouseout = booyah;
					};

					function booyah() { // booyah knows what object it was called on
						this.value = "booyah";
					}
					</code></pre>
					<p class="code-caption">JS</p>

					<div class="output">
						<input id="booyahbox" type="text" />
						<button id="submitbtn">Submit</button>
						<p class="output-caption">output</p>
					</div>
					<p>Event handlers attached unobtrusively are bound to the element</p>
					<p>Inside the handler, that element becomes <code>this</code></p>
				</section>


			</div>
		</div>

		<script src="../../reveal/lib/js/head.min.js"></script>
		<script src="../../reveal/js/reveal.js"></script>

		<script>

			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// More info https://github.com/hakimel/reveal.js#dependencies
				dependencies: [
					{ src: '../../reveal/lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: '../../reveal/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../../reveal/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: '../../reveal/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: '../../reveal/plugin/zoom-js/zoom.js', async: true },
					{ src: '../../reveal/plugin/notes/notes.js', async: true },
          { src: '../../reveal/plugin/search/search.js', async: true },
          { src: '../../reveal/plugin/print-pdf/printpdfbtn.js', async: true }
				]
			});

		</script>
	</body>
</html>
